@model  CommonService.Model.Milepost.J_No_Milepost
@using CommonService.Model;
@using CommonService.Common;
@using Context;
@{
    Layout = "~/Views/Shared/_EditDialogFormTemplate.cshtml";//带表单提交的编辑页面固定模板

    List<V_User_Org_Post> OrgPosts = UIContext.Current.UserOrgPosts;
    //稽查人判断1，当当前人是被稽查人时（隐藏功能按钮-开放被稽查意见功能）
    bool isbjcr = false;
    bool isbcjr = false;
    string validataMsg = "";
    string sxtitle = "首席专家";
    #region 如果是进来填写的情况
    //数据权限验证
    if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.Minister).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.BranchGeneralManager).Count() != 0)//专家部长
    {
        validataMsg = "if ($('#J_No_Milepost_ZUserinfo_code').val() == '请选择' || $('#J_No_Milepost_ZUserinfo_code').val() == '0') {alertMsg.info('请选择一个主办律师！');return;}";
    }
    if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.ChiefExpert).Count() != 0)
    {
        validataMsg = " var sxzjnumber = 2; if ($('#J_No_Milepost_ZUserinfo_code').val() == '请选择' || $('#J_No_Milepost_ZUserinfo_code').val() == '0') {sxzjnumber--; } if ($('#J_No_Milepost_DepUserinfo_code').val() == '请选择' || $('#J_No_Milepost_DepUserinfo_code').val() == '0') {sxzjnumber--; } if (sxzjnumber == 0) { alertMsg.info('请选择一个主办律师或部长！'); return; }";
    }
    if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.GeneralManager).Count() != 0)
    {
        validataMsg = "if ($('#J_No_Milepost_GenerUserinfo_code').val() == '请选择' || $('#J_No_Milepost_GenerUserinfo_code').val() == '0') {alertMsg.info('请选择一个分公司总经理！');return;}";
    }


    #endregion

    #region 如果是进来稽查和确认
    if (Model.J_No_Milepost_CaseNumber != null && Model.J_No_Milepost_CaseNumber != "" && ViewBag.IsMessage)
    {

        //被稽查人判断
        if (Model.J_No_Milepost_ZUserinfo_code == ViewBag.UserCode || Model.J_No_Milepost_DepUserinfo_code == ViewBag.UserCode || Model.J_No_Milepost_GenerUserinfo_code == ViewBag.UserCode)
        {
            isbjcr = true;
        }
        if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.ChiefExpert).Count() != 0)
        {

            isbcjr = true;
        }
        if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.BranchGeneralManager).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.ResearchPresident).Count() != 0)
        {
            sxtitle = "院长";
            isbcjr = true;
        }

    }






    #endregion





}
@{
    ViewBag.Title = "稽查";
}
@section HeadScript{
    <script type="text/javascript">
        document.onkeyup = function (e) {      //onkeyup是javascript的一个事件、当按下某个键弹起 var _key; //的时触发
            if (e == null) { // ie
                _key = event.keyCode;
            } else { // firefox              //获取你按下键的keyCode
                _key = e.which;          //每个键的keyCode是不一样的
            }
            if (_key == 13) {   //判断keyCode是否是13，也就是回车键(回车的keyCode是13)
                ValidataForm(document.getElementById('btnSave'), 1);
            }
        }

        $(document).ready(function () {
            $("#likeCase").hide();
            $("#likeMsg").hide();
            $("#DocM").hide();
            $("#entityChangeDetails").hide();

            $("#J_No_Milepost_CaseNumber").keyup(function () {
                if ($("#J_No_Milepost_CaseNumber").val() == "") {
                    CaseCode = undefined;
                    $("#likeCase").hide();
                } else {
                    $("#likeCase").show();
                    //异步查询数据
                    $.ajax({
                        type: "POST",
                        async: true,
                        url: "/Milepost/NoMilepost/LikeCase/",
                        data: { IsPreSetManager: '@ViewBag.IsPreSetManager', RoleId: '@ViewBag.RoleId', UserCode: '@ViewBag.UserCode', PostCode: '@ViewBag.PostCode', OrgCode: '@ViewBag.OrgCode', LikeName: $("#J_No_Milepost_CaseNumber").val() },
                        success: function (result) {
                            $("#likeCase").html(result);
                        }
                    })
                }



            });



            var IsMessage = "@ViewBag.IsMessage";
            ///反绑定
            if ($("#J_No_Milepost_CaseNumber").val() != "") {


                document.getElementById("J_No_Milepost_DocumentPo").value = '@Model.J_No_Milepost_DocumentPo';
                document.getElementById("J_No_Milepost_Filing").value = '@Model.J_No_Milepost_Filing';
                document.getElementById("J_No_Milepost_Preservation").value = '@Model.J_No_Milepost_Preservation';
                SetCode('@ViewBag.CaseCode');
                //当为审批状态
                if (IsMessage == "True") {

                    if (document.getElementById("J_No_Milepost_AdMessageType") != null) {
                        document.getElementById("J_No_Milepost_AdMessageType").value = '@Model.J_No_Milepost_AdMessageType';
                    }
                    if (document.getElementById("J_No_Milepost_TJMessageType") != null) {
                        document.getElementById("J_No_Milepost_TJMessageType").value = '@Model.J_No_Milepost_TJMessageType';
                    }
                    if (document.getElementById("J_No_Milepost_Z_AdMessageType") != null) {
                        document.getElementById("J_No_Milepost_Z_AdMessageType").value = '@Model.J_No_Milepost_Z_AdMessageType';
                    }
                    if (document.getElementById("J_No_Milepost_Z_TJMessageType") != null) {
                        document.getElementById("J_No_Milepost_Z_TJMessageType").value = '@Model.J_No_Milepost_Z_TJMessageType';
                    }
                    if (document.getElementById("J_No_Milepost_Dep_AdMessageType") != null) {
                        document.getElementById("J_No_Milepost_Dep_AdMessageType").value = '@Model.J_No_Milepost_Dep_AdMessageType';
                    }
                    if (document.getElementById("J_No_Milepost_Dep_TJMessageType") != null) {
                        document.getElementById("J_No_Milepost_Dep_TJMessageType").value = '@Model.J_No_Milepost_Dep_TJMessageType';
                    }

                    //禁用控件
                    $("#J_No_Milepost_JTime").attr("disabled", "disabled");
                    $("#J_No_Milepost_CaseNumber").attr("disabled", "disabled");
                    //$("#J_No_Milepost_DocumentPo").attr("disabled", "disabled");

                    var arrChk = $("input[type='checkbox']");
                    $(arrChk).each(function () {
                        $(this).attr("disabled", "disabled");
                    });



                    $("#J_No_Milepost_Filing").attr("disabled", "disabled");
                    $("#J_No_Milepost_Preservation").attr("disabled", "disabled");

                    $("#J_No_Milepost_ZUserinfo_code").attr("disabled", "disabled");
                    $("#J_No_Milepost_DepUserinfo_code").attr("disabled", "disabled");
                    $("#J_No_Milepost_GenerUserinfo_code").attr("disabled", "disabled");
                }
            }


        });


        function likeMsg_out() {
            $("#likeMsg").hide();
        }
        function likeMsg_move() {
            $("#likeMsg").show();
        }


        function SetCaseNumber(val1, cacode) {
            $("#J_No_Milepost_CaseNumber").val(val1);
            $("#likeCase").hide();


            SetCode(cacode);

        }
        function jccg() {
            if (CaseCode == null || CaseCode == '') return;
            SetCode(CaseCode);
        }


        var CaseCode;
        function SetCode(cacode) {
            CaseCode = cacode;
            //对应主办
            $.ajax({
                type: "POST",
                async: true,
                url: "/Milepost/NoMilepost/ZUserNames",
                data: { CaseCode: cacode, zbcode: '@Model.J_No_Milepost_ZUserinfo_code' },
                success: function (result) {
                    $("#J_No_Milepost_ZUserinfo_code").html(result);

                    $("#zbname").html(document.getElementById("J_No_Milepost_ZUserinfo_code").options[document.getElementById("J_No_Milepost_ZUserinfo_code").options.selectedIndex].text);

                }
            })

            //对应部长
            $.ajax({
                type: "POST",
                async: true,
                url: "/Milepost/NoMilepost/DepUserNames",
                data: { CaseCode: cacode, zbcode: '@Model.J_No_Milepost_DepUserinfo_code' },
                success: function (result) {
                    $("#J_No_Milepost_DepUserinfo_code").html(result);
                    $("#bzname").html(document.getElementById("J_No_Milepost_DepUserinfo_code").options[document.getElementById("J_No_Milepost_DepUserinfo_code").options.selectedIndex].text);

                }
            })

            //对应分总
            $.ajax({
                type: "POST",
                async: true,
                url: "/Milepost/NoMilepost/FZUserNames",
                data: { CaseCode: cacode, zbcode: '@Model.J_No_Milepost_GenerUserinfo_code' },
                success: function (result) {
                    $("#J_No_Milepost_GenerUserinfo_code").html(result);
                }
            })
            $.ajax({
                type: "POST",
                async: true,
                url: "/Milepost/NoMilepost/LikeMsg",
                data: { CaseCode: cacode, type: $("#J_No_Milepost_DocumentPo").val(), msgs: 1, MilepostID: '@Model.J_No_Milepost_id' },
                success: function (result) {
                    if (result == "") {
                        $("#likeMsg").hide();
                        $("#f_msg").show();
                    } else {
                        $("#f_msg").hide();
                    }
                    $("#likemsgtitle").html(result);

                }
            })
            $.ajax({
                type: "POST",
                async: true,
                url: "/Milepost/NoMilepost/LikeMsg",
                data: { CaseCode: cacode, type: $("#J_No_Milepost_DocumentPo").val(), msgs: 2, MilepostID: '@Model.J_No_Milepost_id' },
                success: function (result) {
                    $("#likeMsg").html(result);
                }
            })
        
        }

        function TJ_Ck(number) {


            var typename = "";
            var contentname = "";

            if (number == 0) {

                //判断是否选择意见
                if ($("#J_No_Milepost_Z_TJMessageType").val() == "") {
                    alertMsg.info("请选择意见！");
                    return;
                }

                typename = $("#J_No_Milepost_Z_TJMessageType").val();
                contentname = $("#J_No_Milepost_Z_TJMessageContent").val();


            } else if (number == 1) {

                //判断是否选择意见
                if ($("#J_No_Milepost_Dep_TJMessageType").val() == "") {
                    alertMsg.info("请选择意见！");
                    return;
                }

                typename = $("#J_No_Milepost_Dep_TJMessageType").val();
                contentname = $("#J_No_Milepost_Dep_TJMessageContent").val();


            } else {


                //判断是否选择意见
                if ($("#J_No_Milepost_TJMessageType").val() == "") {
                    alertMsg.info("请选择意见！");
                    return;
                }

                typename = $("#J_No_Milepost_TJMessageType").val();
                contentname = $("#J_No_Milepost_TJMessageContent").val();

            }

            $.ajax({
                type: "POST",
                async: false,
                url: "/Milepost/NoMilepost/TJ_Ck",
                data: { J_No_Milepost_id: '@Model.J_No_Milepost_id', J_No_Milepost_TJMessageType: typename, J_No_Milepost_TJMessageContent: contentname, Number: number },
                success: function (result) {
                    if (result > 0) {
                        alertMsg.info("操作成功！");

                    }
                }
            })

            window.location = window.location;
        }

        function JC_Ck(number) {

            var typename = "";
            var contentname = "";

            //判断是否选择意见
            if ($("#J_No_Milepost_AdMessageType").val() == "") {
                alertMsg.info("请选择意见！");
                return;
            }
            typename = $("#J_No_Milepost_AdMessageType").val();
            contentname = $("#J_No_Milepost_AdMessageContent").val();

            $.ajax({
                type: "POST",
                async: false,
                url: "/Milepost/NoMilepost/JC_Ck",
                data: { J_No_Milepost_id: '@Model.J_No_Milepost_id', J_No_Milepost_AdMessageType: typename, J_No_Milepost_AdMessageContent: contentname, Status: number, J_No_Milepost_DocumentPo: $("#J_No_Milepost_DocumentPo").val(), J_No_Milepost_Filing: $("#J_No_Milepost_Filing").val(), J_No_Milepost_Preservation: $("#J_No_Milepost_Preservation").val(), J_No_Milepost_ZUserinfo_code: $("#J_No_Milepost_ZUserinfo_code").val(), J_No_Milepost_DepUserinfo_code: $("#J_No_Milepost_DepUserinfo_code").val(), J_No_Milepost_GenerUserinfo_code: $("#J_No_Milepost_GenerUserinfo_code").val() },
                success: function (result) {
                    if (result > 0) {
                        alertMsg.info("操作成功！");

                    }
                }
            })
            window.location = window.location;
        }

        function ValidataForm(val, typeid) {

            var number = 0;
            $.ajax({
                type: "POST",
                async: false,
                url: "/Milepost/NoMilepost/ValidataForm",
                data: { J_No_Milepost_CaseNumber: $("#J_No_Milepost_CaseNumber").val() },
                success: function (result) {
                    if (result > 0) {
                        number = 1;

                    }
                }
            });

            @Html.Raw(validataMsg)





            if (number == 1) {
                if (typeid == 1) {
                    onlySaveForm(val);
                } else {
                    saveAndNewNext(val)
                }

            } else {
                alertMsg.info("无法保存，可能是该案件编号不存在或者是该案件无首席专家！");
            }

        }
        function dchange(val) {

            if ($(val).val() == "修改稽查信息") {
                $("#J_No_Milepost_DocumentPo").removeAttr("disabled");
                $("#J_No_Milepost_Filing").removeAttr("disabled");
                $("#J_No_Milepost_Preservation").removeAttr("disabled");

                $("#J_No_Milepost_ZUserinfo_code").removeAttr("disabled");
                $("#J_No_Milepost_DepUserinfo_code").removeAttr("disabled");
                $("#J_No_Milepost_GenerUserinfo_code").removeAttr("disabled");


                var arrChk = $("input[type='checkbox']");
                $(arrChk).each(function () {
                    $(this).removeAttr("disabled");
                });


            } else {
                $("#J_No_Milepost_DocumentPo").attr("disabled", "disabled");
                $("#J_No_Milepost_Filing").attr("disabled", "disabled");
                $("#J_No_Milepost_Preservation").attr("disabled", "disabled");
                $("#J_No_Milepost_ZUserinfo_code").attr("disabled", "disabled");
                $("#J_No_Milepost_DepUserinfo_code").attr("disabled", "disabled");
                $("#J_No_Milepost_GenerUserinfo_code").attr("disabled", "disabled");

                var arrChk = $("input[type='checkbox']");
                $(arrChk).each(function () {
                    $(this).attr("disabled", "disabled");
                });
            }
        }

        function opewh_1(val) {
            if (CaseCode == undefined) {
                alertMsg.info("请选择一个案号！");
                return;
            }
            var url = val + '?fkCode=' + CaseCode + '&fkType=@Convert.ToInt32(FlowTypeEnum.案件)';

            _openDialog('案件执行情况', url, 1200, 600);
        }
        function likemsgf() {
            if (CaseCode == undefined) {
                alertMsg.info("请选择一个案号！");
                return;
            }             
            $("#likeMsg").fadeToggle();
        }
        function Dtl(ID) {
            _openDialog('详情', "/Milepost/NoMilepost/DefaultLayout?J_No_Milepost_id=" + ID, 1200, 600);

        }
        //打开进程条目变更信息容器
        function openEntityChangeDetails() {
            if (CaseCode == undefined) {
                alertMsg.info("请选择一个案号！");
                return;
            }
           
            var client_url = '/MonitorManager/Entry_Change/EntryChangeRecord?pkCode=' + CaseCode;
            $.ajax({
                type: "POST",
                async: true,
                url: client_url,
                success: function (result) {                   
                    $("#entityChangeDetails").html(result);
                }
            })
            $("#entityChangeDetails").fadeToggle();
        }
        //关闭进程条目变更信息容器
        function closeEntityChangeDetails() {
            $("#entityChangeDetails").hide();
        }
        //移动进程条目变更信息容器
        function moveEntityChangeDetails() {
            $("#entityChangeDetails").show();
        }
    </script>
}
<style>
    a {
        font-size: 12px;
        color: blue;
        text-decoration: underline;
    }

        a:hover {
            font-size: 12px;
            color: blue;
            text-decoration: underline;
        }

    .style a {
        text-decoration: underline;
    }
</style>
<div class="formbody" style="overflow: auto; height:600px; ">
    <div class="formtitle"><span>基本信息</span></div>
    <ul class="forminfo">
        @using (Html.BeginForm("Save", "NoMilepost", FormMethod.Post, new { id = "formJ_No_Milepost", onsubmit = "return validateCallback(this,dialogAjaxDone);" }))
        {
            @Html.Hidden("formOperateType")//表单操作类型：固定写法，只是保存，值为'onlySave';保存并且新增，值为'saveAndNewNext'
                                        @Html.Hidden("J_No_Milepost_id", Model.J_No_Milepost_id)
                                        @Html.Hidden("J_No_Milepost_code", Model.J_No_Milepost_code)
                                        @Html.Hidden("J_No_Milepost_isDelete", Model.J_No_Milepost_isDelete)
                                        @Html.Hidden("J_No_Milepost_Auditor", Model.J_No_Milepost_Auditor)
                                        @Html.Hidden("J_No_Milepost_createTime", Model.J_No_Milepost_createTime)



                                        <li>
                                            <label>稽查时间</label>@Html.TextBox("J_No_Milepost_JTime", Model.J_No_Milepost_JTime == null ? "" : Model.J_No_Milepost_JTime.ToString("yyyy-MM-dd HH:mm:ss"), new { date = "date", maxlength = "20", @readonly = "readonly", dateformat = "yyyy-MM-dd HH:mm:ss", @class = "dfinput", requiredInput = "请选择日期" })<i></i>
                                            <a title="案件执行情况" style="cursor:pointer;" dialogwidth="1250" dialogheight="650" edit="edit" onclick="opewh_1('/casemanager/caseexecute/DefaultLayout')"><span><img src="/theme/images/goexe.png" /></span></a>
                                        </li>

                                        <li>
                                            <label>案号</label>@Html.TextBox("J_No_Milepost_CaseNumber", Model.J_No_Milepost_CaseNumber, new { @class = "dfinput", requiredInput = "请输入案件编号", maxlength = "50" })
                                            <i title="点击查看更多" id="likemsgtitle"></i>
                                            <a id="delaySituation" href="#" onmouseout="closeEntityChangeDetails()" onclick="openEntityChangeDetails()" class="style">进程情况</a>
                                            <a href="#" onmouseout="likeMsg_out()" onclick="likemsgf()" class="style">稽查历史</a><font id="f_msg" style="color:gray;">（注：请录入案件号后点击查看稽查历史）</font>                                            
                                        </li>

                                        <li>
                                            <label>稽核事项</label>
                                            @{
                                                string docuname = "";
                                                if (Model.J_No_Milepost_DocumentPo != null && Model.J_No_Milepost_DocumentPo != "")
                                                {
                                                   docuname = Model.J_No_Milepost_DocumentPo;
                                                }
                                            }
                                            <input type="text" width="300px" name="J_No_Milepost_DocumentPo_dtl" id="J_No_Milepost_DocumentPo_dtl" class="dfinput" readonly="readonly" value="@docuname" onmouseout="DocM_out()" onmousemove=" DocM_move()" />

                                            <input type="text" style="visibility:hidden" width="300px" name="J_No_Milepost_DocumentPo" id="J_No_Milepost_DocumentPo" class="dfinput" readonly="readonly" value="@Model.J_No_Milepost_DocumentPo" />

                                            <i></i>
                                        </li>

                                        <li>
                                            <label>稽核原因</label>
                                            <select name="J_No_Milepost_Filing" id="J_No_Milepost_Filing">
                                                <option value="不做">不做</option>
                                                <option value="未在规定的时间内完成">未在规定的时间内完成</option>
                                                <option value="未在规定时间内确认">未在规定时间内确认</option>
                                                <option value="完成">完成</option>
                                            </select>
                                            <i></i>
                                        </li>

                                        <li>
                                            <label>稽核结果</label>
                                            <select name="J_No_Milepost_Preservation" id="J_No_Milepost_Preservation">
                                                <option value="不处罚">不处罚</option>
                                                <option value="罚款50元">罚款50元</option>
                                                <option value="罚款50元并更换承办律师">罚款50元并更换承办律师</option>
                                            </select>
                                            <i></i>
                                        </li>

                                        <li><label>稽核人</label>@Model.J_No_Milepost_AuditorName<i></i></li>

                                        <div class="formtitle"><span>稽核对象</span></div>

            if (UIContext.Current.IsPreSetManager)
            {
                <li>
                    <label>独立/主办律师</label>
                    <select name="J_No_Milepost_ZUserinfo_code" id="J_No_Milepost_ZUserinfo_code">
                        <option value="0">请选择一个案件</option>
                    </select>
                    <i></i>
                    <label style="text-align:center">部长</label>
                    <select name="J_No_Milepost_DepUserinfo_code" id="J_No_Milepost_DepUserinfo_code">
                        <option value="0">请选择一个案件</option>
                    </select>
                    <i></i>
                </li>
                <li>
                    <label>分公司总经理</label>
                    <select name="J_No_Milepost_GenerUserinfo_code" id="J_No_Milepost_GenerUserinfo_code">
                        <option value="0">请选择一个案件</option>
                    </select>
                    <i></i>
                </li>


            }


            if (!ViewBag.IsMessage)
            {
                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.Minister).Count() != 0)
                {
                    <li>
                        <label>独立/主办律师</label>
                        <select name="J_No_Milepost_ZUserinfo_code" id="J_No_Milepost_ZUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>

                    </li>
                }

                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.BranchGeneralManager).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.ChiefExpert).Count() != 0
                    || OrgPosts.Where(r => r.PostGroupCode == PostGroup.HumanResources).Count() != 0)
                {
                    <li>
                        <label>独立/主办律师</label>
                        <select name="J_No_Milepost_ZUserinfo_code" id="J_No_Milepost_ZUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>
                        <label style="text-align:center">部长</label>
                        <select name="J_No_Milepost_DepUserinfo_code" id="J_No_Milepost_DepUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>
                    </li>


                }
                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.GeneralManager).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.HumanResources).Count() != 0)
                {
                    <li>
                        <label>分公司总经理</label>
                        <select name="J_No_Milepost_GenerUserinfo_code" id="J_No_Milepost_GenerUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>
                    </li>
                }
            }
            else
            {


                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.ChiefExpert).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.HumanResources).Count() != 0
                    || OrgPosts.Where(r => r.PostGroupCode == PostGroup.BranchGeneralManager).Count() != 0)
                {
                    <li>
                        <label>独立/主办律师</label>
                        <select name="J_No_Milepost_ZUserinfo_code" id="J_No_Milepost_ZUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>

                    </li>

                    <li>
                        <label>部长</label>
                        <select name="J_No_Milepost_DepUserinfo_code" id="J_No_Milepost_DepUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>
                    </li>

                }
                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.BranchGeneralManager).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.ResearchPresident).Count() != 0
                    || OrgPosts.Where(r => r.PostGroupCode == PostGroup.GeneralManager).Count() != 0 || OrgPosts.Where(r => r.PostGroupCode == PostGroup.HumanResources).Count() != 0)
                {
                    <li>
                        <label>分公司总经理</label>
                        <select name="J_No_Milepost_GenerUserinfo_code" id="J_No_Milepost_GenerUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>
                    </li>
                }
                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.Minister).Count() != 0)
                {
                    <li>
                        <label>部长</label>
                        <select name="J_No_Milepost_DepUserinfo_code" id="J_No_Milepost_DepUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>
                    </li>
                }

                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.HostLawyer).Count() != 0)
                {
                    <li>
                        <label>独立/主办律师</label>
                        <select name="J_No_Milepost_ZUserinfo_code" id="J_No_Milepost_ZUserinfo_code">
                            <option value="0">请选择一个案件</option>
                        </select>
                        <i></i>

                    </li>
                }
            }
            if (ViewBag.IsMessage)
            {
                <div class="formtitle"><span>被稽核人意见</span></div>
                if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.Minister).Count() != 0)
                {
                    <li>
                        <label>部长</label>
                        <label id="bzname"></label>
                        <i></i>
                    </li>
                    <li>
                        <label>意见</label>
                        <select name="J_No_Milepost_Dep_TJMessageType" id="J_No_Milepost_Dep_TJMessageType">
                            <option value=""></option>
                            <option value="同意">同意</option>
                            <option value="不同意">不同意</option>
                        </select>
                    </li>
                    <li>
                        <label>备注</label>
                        <textarea name="J_No_Milepost_Dep_TJMessageContent" id="J_No_Milepost_Dep_TJMessageContent" rows="5" cols="27">@Model.J_No_Milepost_Dep_TJMessageContent</textarea>
                        <i></i>
                    </li>
                    <li>
                        @if (isbjcr && Model.J_No_Milepost_Dep_AdStatus == 1)
                        {
                        <label></label>
                        <input name="" type="button" id="btnSave" onclick="TJ_Ck(1)" class="btn btnmr fl" value="提交稽查确认" /><i></i>
                        }
                        else
                        {
                        <script>
                                $("#J_No_Milepost_Dep_TJMessageType").attr("disabled", "disabled");
                                $("#J_No_Milepost_Dep_TJMessageContent").attr("disabled", "disabled");
                        </script>
                        }

                    </li>

                }
                else if (OrgPosts.Where(r => r.PostGroupCode == PostGroup.HostLawyer).Count() != 0)
                {
                    <li>
                        <label>主办</label>
                        <label id="zbname"></label>
                        <i></i>
                    </li>
                    <li>
                        <label>意见</label>
                        <select name="J_No_Milepost_Z_TJMessageType" id="J_No_Milepost_Z_TJMessageType">
                            <option value=""></option>
                            <option value="同意">同意</option>
                            <option value="不同意">不同意</option>
                        </select>
                    </li>
                    <li>
                        <label>备注</label>
                        <textarea name="J_No_Milepost_Z_TJMessageContent" id="J_No_Milepost_Z_TJMessageContent" rows="5" cols="27">@Model.J_No_Milepost_Z_TJMessageContent</textarea>
                        <i></i>
                    </li>
                    <li>
                        @if (isbjcr && Model.J_No_Milepost_Z_AdStatus == 1)
                        {
                            <label></label>
                            <input name="" type="button" id="btnSave" onclick="TJ_Ck(0)" class="btn btnmr fl" value="提交稽查确认" /><i></i>
                        }
                        else
                        {
                            <script>
                                $("#J_No_Milepost_Z_TJMessageType").attr("disabled", "disabled");
                                $("#J_No_Milepost_Z_TJMessageContent").attr("disabled", "disabled");
                            </script>
                        }

                    </li>

                }
                else
                {
                    if (Model.J_No_Milepost_GenerUserinfo_code.ToString() != "00000000-0000-0000-0000-000000000000")
                    {

                        <li>
                            <label>意见</label>
                            <select name="J_No_Milepost_TJMessageType" id="J_No_Milepost_TJMessageType">
                                <option value=""></option>
                                <option value="同意">同意</option>
                                <option value="不同意">不同意</option>
                            </select>
                        </li>
                        <li>
                            <label>备注</label>
                            <textarea name="J_No_Milepost_TJMessageContent" id="J_No_Milepost_TJMessageContent" rows="5" cols="27">@Model.J_No_Milepost_TJMessageContent</textarea>
                            <i></i>
                        </li>
                        <li>
                            @if (isbjcr && Model.J_No_Milepost_AdStatus == 1)
                            {
                                <label></label>
                                <input name="" type="button" id="btnSave" onclick="TJ_Ck(2)" class="btn btnmr fl" value="提交稽查确认" /><i></i>
                            }
                            else
                            {
                                <script>
                                    $("#J_No_Milepost_TJMessageType").attr("disabled", "disabled");
                                    $("#J_No_Milepost_TJMessageContent").attr("disabled", "disabled");
                                </script>
                            }

                        </li>
                    }
                    else
                    {

                        <table>

                            <tr>

                                @if (Model.J_No_Milepost_DepUserinfo_code.ToString() != "00000000-0000-0000-0000-000000000000")
                                {


                                    <td width="400">
                            <li>
                                <label>部长</label>
                                <label id="bzname"></label>
                                <i></i>
                            </li>
                            <li>
                                <label>意见</label>
                                <select name="J_No_Milepost_Dep_TJMessageType" id="J_No_Milepost_Dep_TJMessageType">
                                    <option value=""></option>
                                    <option value="同意">同意</option>
                                    <option value="不同意">不同意</option>
                                </select>
                            </li>
                            <li>
                                <label>备注</label>
                                <textarea name="J_No_Milepost_Dep_TJMessageContent" id="J_No_Milepost_Dep_TJMessageContent" rows="5" cols="27">@Model.J_No_Milepost_Dep_TJMessageContent</textarea>
                                <i></i>
                            </li>
                            <li>
                                @if (isbjcr && Model.J_No_Milepost_Dep_AdStatus == 1)
                                {
                                    <label></label>
                                    <input name="" type="button" id="btnSave" onclick="TJ_Ck(1)" class="btn btnmr fl" value="提交稽查确认" /><i></i>
                                }
                                else
                                {
                                    <script>
                                        $("#J_No_Milepost_Dep_TJMessageType").attr("disabled", "disabled");
                                        $("#J_No_Milepost_Dep_TJMessageContent").attr("disabled", "disabled");
                                    </script>
                                }

                            </li>
                            </td>
                                }
                                @if (Model.J_No_Milepost_ZUserinfo_code.ToString() != "00000000-0000-0000-0000-000000000000")
                                {

                                    <td>

                                    <li>
                                        <label>主办</label>
                                        <label id="zbname"></label>
                                        <i></i>
                                    </li>
                                    <li>
                                        <label>意见</label>
                                        <select name="J_No_Milepost_Z_TJMessageType" id="J_No_Milepost_Z_TJMessageType">
                                            <option value=""></option>
                                            <option value="同意">同意</option>
                                            <option value="不同意">不同意</option>
                                        </select>
                                    </li>
                                    <li>
                                        <label>备注</label>
                                        <textarea name="J_No_Milepost_Z_TJMessageContent" id="J_No_Milepost_Z_TJMessageContent" rows="5" cols="27">@Model.J_No_Milepost_Z_TJMessageContent</textarea>
                                        <i></i>
                                    </li>
                                    <li>
                                        @if (isbjcr && Model.J_No_Milepost_Z_AdStatus == 1)
                                        {
                                            <label></label>
                                            <input name="" type="button" id="btnSave" onclick="TJ_Ck(0)" class="btn btnmr fl" value="提交稽查确认" /><i></i>
                                        }
                                        else
                                        {
                                            <script>
                                                $("#J_No_Milepost_Z_TJMessageType").attr("disabled", "disabled");
                                                $("#J_No_Milepost_Z_TJMessageContent").attr("disabled", "disabled");
                                            </script>
                                        }

                                    </li>



                                    </td>
                                }
                                </tr>
                                </table>
                    }
                }
                <br />

                <div class="formtitle"><span>@Html.Raw(sxtitle + "裁定")</span></div>

                <li>
                    <label>意见</label>
                    <select name="J_No_Milepost_AdMessageType" id="J_No_Milepost_AdMessageType" onchange="dchange(this)">
                        <option value=""></option>
                        <option value="维持原稽查意见">维持原稽查意见</option>
                        <option value="修改稽查信息">修改稽查信息</option>
                    </select>
                </li>
                <li>
                    <label>备注</label>
                    <textarea name="J_No_Milepost_AdMessageContent" id="J_No_Milepost_AdMessageContent" rows="5" cols="27">@Model.J_No_Milepost_AdMessageContent</textarea>
                    <i></i>
                </li>
                if (isbcjr && Model.J_No_Milepost_AdStatus == 2)
                {
                    <li class="buttonWrap clear"><label>&nbsp;</label><input name="" type="button" id="btnSave" onclick="JC_Ck(3)" class="btn btnmr fl" value="确认" /><i></i><input name="" id="btnSaveAndNewNext" type="button" onclick="JC_Ck(4)" class="btn btnmr fl" value="裁决" /><i></i></li>
                }
                else
                {
                    <script>
                        $("#J_No_Milepost_AdMessageType").attr("disabled", "disabled");
                        $("#J_No_Milepost_AdMessageContent").attr("disabled", "disabled");
                    </script>
                }
            }
            if (!isbjcr && !isbcjr && !ViewBag.IsMessage && Model.J_No_Milepost_AdStatus <= 1)
            {
                <li class="buttonWrap clear"><label>&nbsp;</label><input name="" type="button" id="btnSave" onclick="ValidataForm(this,1)" class="btn btnmr fl" value="确认保存" /><i></i><input name="" id="btnSaveAndNewNext" type="button" onclick="ValidataForm(this,2)" class="btn btnmr fl" value="保存并新增下一个" /><i></i></li>
            }
        }
    </ul>
</div>

<div id="likeCase" style="left: 145px; top: 145px; width: 348px; height: 200px; background-color: #CCFFCC; position: absolute; overflow: auto; border: 1px solid #009900; ">
    <table class="tablelist">
        <tbody style="cursor:pointer;">
            <tr target="sid_Iterm" rel="">
                <td>模糊匹配中，请稍后...</td>
            </tr>
        </tbody>
    </table>
</div>
<div id="likeMsg" onmouseout="likeMsg_out()" onmousemove="likeMsg_move()" style="left: 515px; top: 135px; width: 400px; height: 200px; background-color: #CCFFCC; position: absolute; overflow: auto; border: 1px solid #009900; ">
    <table class="tablelist">
        <tbody style="cursor:pointer;">
            <tr>
                <td>匹配中，请稍后...</td>
            </tr>
        </tbody>
    </table>
</div>
<!--进程条目变更信息容器-->
<div id="entityChangeDetails" onmouseout="closeEntityChangeDetails()" onmousemove="moveEntityChangeDetails()" style="left: 140px; top: 135px; width: 900px; height: 200px; background-color: #CCFFCC; position: absolute; overflow: auto; border: 1px solid #009900; ">
    <table class="tablelist">
        <tbody style="cursor:pointer;">
            <tr>
                <td>匹配中，请稍后...</td>
            </tr>
        </tbody>
    </table>
</div>

<div id="DocM" onmouseout="DocM_out()" onmousemove=" DocM_move()" style="left: 145px; top: 190px; width: 344px; height: 400px; background-color: #CCFFCC; position: absolute; overflow: auto; border: 1px solid #009900; ">
    <table class="tablelist">
        <tbody>

            @{
                List<string> Lst = ViewBag.Lst;
                int i = 0;
                foreach (var item in Lst)
                {
                    <tr target="sid_Iterm" rel="">
                        <td valign="bottom">
                            @if (Model.J_No_Milepost_DocumentPo != null && Model.J_No_Milepost_DocumentPo.Contains("," + item + ","))
                            {
                                <input type="checkbox" checked="checked" value="@item" id="@Html.Raw("ck" + i)" onclick="ock(this)" /> <label for="@Html.Raw("ck" + i)">&nbsp;@item</label>
                            }
                            else
                            {
                                <input type="checkbox" value="@item" id="@Html.Raw("ck" + i)" onclick="ock(this)" /> <label for="@Html.Raw("ck" + i)">&nbsp;@item</label>
                            }
                        </td>
                    </tr>
                            i++;
                }
            }


        </tbody>

    </table>
</div>
<script>
    function DocM_out() {
        $("#DocM").hide();
    }

    function DocM_move() {
        $("#DocM").show();
    }
    function ock(val) {
        if (val.checked == true) {
            if ($("#J_No_Milepost_DocumentPo").val() == "") {

                $("#J_No_Milepost_DocumentPo_dtl").val(val.value);
                $("#J_No_Milepost_DocumentPo").val("," + val.value + ",");
            } else {
                if ($("#J_No_Milepost_DocumentPo").val().substr($("#J_No_Milepost_DocumentPo").val().length - 1, 1) == ",") {
                    $("#J_No_Milepost_DocumentPo").val($("#J_No_Milepost_DocumentPo").val() + val.value + ",");


                }
                else {
                    $("#J_No_Milepost_DocumentPo").val($("#J_No_Milepost_DocumentPo").val() + "," + val.value + ",");


                }
            }

        } else {
            $("#J_No_Milepost_DocumentPo").val($("#J_No_Milepost_DocumentPo").val().replace("," + val.value + ",", ","));


            if ($("#J_No_Milepost_DocumentPo_dtl").val() == ",") {
                $("#J_No_Milepost_DocumentPo_dtl").val("");
            }
            if ($("#J_No_Milepost_DocumentPo").val() == ",") {
                $("#J_No_Milepost_DocumentPo").val("");
            }

        }
        if ($("#J_No_Milepost_DocumentPo_dtl").val() != "") {
            $("#J_No_Milepost_DocumentPo_dtl").val($("#J_No_Milepost_DocumentPo").val().substr(1, $("#J_No_Milepost_DocumentPo").val().length - 2));
        } else {
            $("#J_No_Milepost_DocumentPo_dtl").val("");
        }
        jccg();
    }
</script>